---
title: "Treatment effects"
author: "Monica Zamudio"
date: "November 28, 2017"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, error = FALSE)

source('setup-toolbox.R', encoding = 'utf8')
source('clustered_regs_toolbox.R')

```

These are some initial regressions on treatment effects. There are some notes to be made in order to best interpret regressions: 

1. Basic controls are: Gender, Daily wage and Tenure. Each column indicates whether these controls were added to the specification or not.

2. Observing that out treated subjects become "more optimistic" or "less informed" in their expectations might be misguided to selection bias, since treated subjects have a higher probability of having solved the conflict after 2 months.

3. All standard errors are clustered by day.

```{r}
load('pdatasets.RData')
```


## After-treatment expectations

```{r, results = 'asis'}

###############################

# Expectations

##############################

depvar_list = c(rep('cantidad_ganar_survey', 2),
                 rep('cant_mayor_survey', 2),
                 rep('prob_ganar_survey', 2),
                 rep('prob_mayor_survey', 2))

rename_list = rep(c(F, F, F, F), 2)

newname_list = c(rep('cantidad_ganar_survey', 4),
                 rep('prob_ganar_survey', 4))


controls_list = rep(list(NULL, c('genero', 'antiguedad', 'salario_diario')), 4)


results_exp = map(1:8, function(x) plm_clustered(data = df_2w_main,
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_main',
                                             rename_dep_var = rename_list[x],
                                             new_name = newname_list[x],
                                             controls = controls_list[[x]]))


stargazer(lapply(results_exp, `[[`, 1),
          #type = 'html',
          out.header = F,
          out = '../Tables/te_exp.tex',
          dep.var.labels.include = F,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento_main'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Amt. Expectation', 'Amt. More than mean', 'Prob. Expectation', 'Prob. More than mean'),
          column.separate = rep(2, 4),
          intercept.bottom = F,
          digits = 2,
          header = F,
          table.placement = 'h',
          se = lapply(results_exp, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 4)),
                           c('Obs. per group', unlist(lapply(results_exp, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_exp, `[[`, 4))),
                           c('Source', rep('2w', 8)),
                           c('Conditioned on:', rep('Not solved', 8))),
          notes = "",
          notes.append = F,
          notes.align = 'l',
          notes.label = '')
```

\textbf{Notes:} *The outcome variables are encoded as the answer to the following questions:*
*(1)(2): In case of winning a court ruling, how much do you expect to win?*
*(3)(4): If subject doesn't know the amount, we ask: do you think it would be more than 6 months worth of salaries, or less than that?. \textbf{Important: if the subject gave us an amount, we check whether this is more than 6 months or not, and code that into the same dummy variable.}*
*(5)(6): What is the probability of winning a positive amount of money, in case of a court ruling?*
*(7)(9): This is completely analogous to (3) and (4), but with 75% probability.}*
*Expectation variables are subjects' numeric expectation, while more than mean variables are the union of the numeric answers and the more than mean question, which is asked only when subjects don't give a numeric answer. Compensation expectations are to be read in thousands of pesos.*

\pagebreak

## After-treatment knowledge of own expectations

```{r, results = 'asis'}
###############################

# Knowledge

##############################

depvar_list = c(rep('cantidad_num_survey', 2),
                 rep('cantidad_coarse_survey', 2),
                 rep('prob_num_survey', 2),
                 rep('prob_coarse_survey', 2))

rename_list = rep(c(F, F, F, F), 2)

newname_list = c(rep('cantidad_num_survey', 4),
                 rep('prob_num_survey', 4))


controls_list = rep(list(NULL, c('genero', 'antiguedad', 'salario_diario')), 4)


results_know = map(1:8, function(x) plm_clustered(data = df_2w_main,
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_main',
                                             rename_dep_var = rename_list[x],
                                             new_name = newname_list[x],
                                             controls = controls_list[[x]]))


stargazer(lapply(results_know, `[[`, 1),
          out = '../Tables/te_knowexp.tex',
          column.sep.width = '3pt',
          dep.var.labels.include = F,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Exact Amt.', 'At least coarse Amt.', 'Exact Prob.', 'At least coarse Prob.'),
          column.separate = rep(2, 4),
          intercept.bottom = F,
          #type = 'html',
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_know, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 4)),
                           c('Obs. per group', unlist(lapply(results_know, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_know, `[[`, 4))),
                           c('Source', rep('2w', 8)),
                           c('Conditioned on:', rep('Not solved', 8))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\textbf{Notes:} *These variables depict whether we have an exact or at least coarse amount answer for post-treatment (2 weeks after) expectations.*

\pagebreak

## Case outcomes
### Main arms

```{r, results = 'asis'}

depvar_list = c(rep('conflicto_arreglado', 4),
                rep('entablo_demanda', 2),
                rep('hablo_con_abogado', 2),
                rep('cond_hablo_con_publico', 2),
                rep('demando_con_abogado_publico', 2))


controls_list = rep(list(NULL, c('genero', 'antiguedad', 'salario_diario')), 12)

data_list = c(rep('df_2w_main', 2),
              rep('df_2m_main', 4),
              rep('df_2w_main', 4),
              rep('sued_2m', 2))

results_out_main_1 = map(1:6, function(x) plm_clustered(data = get(data_list[x]),
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_main',
                                             rename_dep_var = F,
                                             controls = controls_list[[x]]))


stargazer(lapply(results_out_main_1, `[[`, 1),
          out = '../Tables/te_main_1.tex',
          out.header = F,
          column.sep.width = '1pt',
          dep.var.labels.include = FALSE,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          #type = 'html',
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Solved conflict', 'Sued'),
          column.separate = c(4, 2),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_out_main_1, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 3)),
                           c('Obs. per group', unlist(lapply(results_out_main_1, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_out_main_1, `[[`, 4))),
                           c('Source', '2w', '2w', '2m', '2m', '2m', '2m'),
                           c('Conditioned on:', rep('-', 6))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\textbf{Notes:} *The outcome variables are encoded as a positive answer to the following questions:*
*(1)(2)(3)(4): Did you solve the conflict?*
*(5)(6): Did you sue your ex-employer?*

```{r, results = 'asis'}

results_out_main_2 = map(7:12, function(x) plm_clustered(data = get(data_list[x]),
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_main',
                                             rename_dep_var = F,
                                             controls = controls_list[[x]]))


stargazer(lapply(results_out_main_2, `[[`, 1),
          out = '../Tables/te_main_2.tex',
          out.header = F,
          column.sep.width = '1pt',
          dep.var.labels.include = FALSE,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          #type = 'html',
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Talked to a lawyer', 'Talked to public lawyer', 'Sued w. Public'),
          column.separate = c(2, 2, 2),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_out_main_2, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 3)),
                           c('Obs. per group', unlist(lapply(results_out_main_2, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_out_main_2, `[[`, 4))),
                           c('Source', rep('2w', 4), rep('2m', 2)),
                           c('Conditioned on:', rep('-', 2),'Ttl', 'Ttl', 'Sued', 'Sued')),
          notes = '',
          notes.append = F,
          notes.label = '')
```


\textbf{Note:} *Ttl* stands for "talked to any lawyer".

\pagebreak

### A vs. B

```{r, results = 'asis'}


data_list = c(rep('df_2w_ab', 2),
              rep('df_2m_ab', 4),
              rep('df_2w_ab', 4),
              rep('sued_2m_ab', 2))

results_out_ab_1 = map(1:6, function(x) plm_clustered(data = get(data_list[x]),
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_ab',
                                             rename_dep_var = F,
                                             controls = controls_list[[x]]))


stargazer(lapply(results_out_ab_1, `[[`, 1),
          out = '../Tables/te_ab_1.tex',
          out.header = F,
          column.sep.width = '1pt',
          dep.var.labels.include = FALSE,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          #type = 'html',
          covariate.labels = c('Constant', 'Treatment B'),
          column.labels = c('Solved conflict', 'Sued'),
          column.separate = c(4, 2),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_out_ab_1, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 3)),
                           c('Obs. per group', unlist(lapply(results_out_ab_1, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_out_ab_1, `[[`, 4))),
                           c('Source', '2w', '2w', '2m', '2m', '2m', '2m'),
                           c('Conditioned on:', rep('-', 6))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\textbf{Notes:} *The outcome variables are encoded as a positive answer to the following questions:*
*(1)(2)(3)(4): Did you solve the conflict?*
*(5)(6): Did you sue your ex-employer?*

```{r, results = 'asis'}

results_out_ab_2 = map(7:12, function(x) plm_clustered(data = get(data_list[x]),
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_ab',
                                             rename_dep_var = F,
                                             controls = controls_list[[x]]))


stargazer(lapply(results_out_ab_2, `[[`, 1),
          out = '../Tables/te_ab_2.tex',
          out.header = F,
          column.sep.width = '1pt',
          dep.var.labels.include = FALSE,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          #type = 'html',
          covariate.labels = c('Constant', 'Treatment B'),
          column.labels = c('Talked to any lawyer', 'Talked to public lawyer', 'Sued w. Public'),
          column.separate = c(2, 2, 2),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_out_ab_2, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 3)),
                           c('Obs. per group', unlist(lapply(results_out_ab_2, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_out_ab_2, `[[`, 4))),
                           c('Source', rep('2w', 4), rep('2m', 2)),
                           c('Conditioned on:', rep('-', 2),'Ttl', 'Ttl', 'Sued', 'Sued')),
          notes = '',
          notes.append = F,
          notes.label = '')
```


\textbf{Note:} *Ttl* stands for "talked to any lawyer".

\pagebreak

## Disaggregating A-B treatment groups
```{r, results = 'asis'}

data_list = c(rep('df_2w_ab', 2),
              rep('df_2m_ab', 4),
              rep('df_2w_ab', 4),
              rep('sued_2m_ab', 2))

results_out_ab_1a = map(1:6, function(x) plm_clustered(data = get(data_list[x]),
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_orig',
                                             rename_dep_var = F,
                                             controls = controls_list[[x]]))


stargazer(lapply(results_out_ab_1a, `[[`, 1),
          out = '../Tables/te_ab_1a.tex',
          out.header = F,
          column.sep.width = '1pt',
          dep.var.labels.include = FALSE,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento_orig'),
          #type = 'html',
          covariate.labels = c('Constant', '1B', '2A', '2B', ''),
          column.labels = c('Solved conflict', 'Sued'),
          column.separate = c(2, 4),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_out_ab_1a, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 3)),
                           c('Obs. per group', unlist(lapply(results_out_ab_1a, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_out_ab_1a, `[[`, 4))),
                           c('Source', '2w', '2w', '2m', '2m', '2m', '2m'),
                           c('Conditioned on:', rep('-', 6))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\textbf{Notes:} *The outcome variables are encoded as a positive answer to the following questions:*
*(1)(2)(3)(4): Did you solve the conflict?*
*(5)(6): Did you sue your ex-employer?*

```{r, results = 'asis'}

results_out_ab_2a = map(7:12, function(x) plm_clustered(data = get(data_list[x]),
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_orig',
                                             rename_dep_var = F,
                                             controls = controls_list[[x]]))


stargazer(lapply(results_out_ab_2a, `[[`, 1),
          out = '../Tables/te_ab_2a.tex',
          out.header = F,
          column.sep.width = '1pt',
          dep.var.labels.include = FALSE,
          dep.var.caption = '',
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento_orig'),
          #type = 'html',
          covariate.labels = c('Constant', '1B', '2A', '2B'),
          column.labels = c('Talked to any lawyer', 'Talked to public lawyer', 'Sued w. Public'),
          column.separate = c(2, 2, 2),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_out_ab_2a, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 3)),
                           c('Obs. per group', unlist(lapply(results_out_ab_2a, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_out_ab_2a, `[[`, 4))),
                           c('Source', rep('2w', 4), rep('2m', 2)),
                           c('Conditioned on:', rep('-', 2),'Ttl', 'Ttl', 'Sued', 'Sued')),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\pagebreak

## Updating

```{r, results = 'asis'}

depvar_list = c(rep('update_comp_survey', 2),
                 rep('switched_comp_survey', 2),
                 rep('update_prob_survey', 2),
                 rep('switched_prob_survey', 2))

newname_list = c(rep('update_comp_survey', 4),
                 rep('update_prob_survey', 4))


controls_list = rep(list(NULL, c('genero', 'antiguedad', 'salario_diario')), 4)


results_up = map(1:8, function(x) plm_clustered(data = df_2w_main,
                                             dep_var = depvar_list[x],
                                             treatment_var = 'grupo_tratamiento_main',
                                             rename_dep_var = F,
                                             new_name = newname_list[x],
                                             controls = controls_list[[x]]))



stargazer(lapply(results_up, `[[`, 1),
          out = '../Tables/te_update.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Amt. Updating', 'Amt. Switched', 'Prob. Updating', 'Prob. Switched'),
          column.separate = rep(2, 4),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          se = lapply(results_up, `[[`, 2),
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Basic Controls', rep(c('NO', 'YES'), 4)),
                           c('Obs. per group', unlist(lapply(results_up, `[[`, 3))),
                           c('Days per group', unlist(lapply(results_up, `[[`, 4))),
                           c('Source', rep('2w', 8)),
                           c('Conditioned on:', rep('Not solved', 8))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\textbf{Notes:} *Updating is measured by our relative updating expression: $\frac{2w - baseline}{baseline}$. Switched variables are dummies indicating whether subject is above the mean in her baseline answer, and below the mean in her two weeks answer.*

\pagebreak

# Balance

## Main Arms

### Two weeks
```{r, results = 'asis'}

# Crear dataset

depvar_list = c('survey_2w',
                'genero',
                'salario_diario',
                'antiguedad', 
                'mon_tues',
                'angry',
                'mas_secundaria',
                'prob_ganar',
                'prob_mayor',
                'cantidad_ganar',
                'cant_mayor')

data_list = c('treatment_data_surveys',
          rep('treatment_data_2w', 10))


balance_main_1_2w = map(1:7, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_main', data = get(data_list[x])))


stargazer(lapply(balance_main_1_2w, `[[`, 1),
          out = '../Tables/balance_main_1_2w.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Success', 'Woman', 'Daily Wage', 'Tenure', 'Mon-Tu', 'Angry', 'More than Junior High'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_main_1_2w, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```


```{r, results = 'asis'}

# Crear dataset


balance_main_2_2w = map(7:10, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_main', data = treatment_data_2w))


stargazer(lapply(balance_main_2_2w, `[[`, 1),
          out = '../Tables/balance_main_2_2w.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Baseline Probability', 'Baseline Prob. Above', 'Baseline Amt.', 'Baseline Amt. Above'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_main_2_2w, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\pagebreak

### 2 Months

```{r, results = 'asis'}

# Crear dataset

depvar_list = c('survey_2m',
                'genero',
                'salario_diario',
                'antiguedad', 
                'mon_tues',
                'angry',
                'mas_secundaria',
                'prob_ganar',
                'prob_mayor',
                'cantidad_ganar',
                'cant_mayor')

data_list = c('treatment_data_surveys',
          rep('treatment_data_2m', 10))


balance_main_1_2m = map(1:7, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_main', data = get(data_list[x])))


stargazer(lapply(balance_main_1_2m, `[[`, 1),
          out = '../Tables/balance_main_1_2m.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Success', 'Woman', 'Daily Wage', 'Tenure', 'Mon-Tu', 'Angry', 'More than Junior High'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_main_1_2m, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```


```{r, results = 'asis'}

# Crear dataset


balance_main_2_2m = map(7:10, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_main', data = treatment_data_2m))


stargazer(lapply(balance_main_2_2m, `[[`, 1),
          out = '../Tables/balance_main_2_2m.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Baseline Probability', 'Baseline Prob. Above', 'Baseline Amt.', 'Baseline Amt. Above'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_main_2_2m, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\pagebreak

## A vs. B

### Two weeks
```{r, results = 'asis'}

# Crear dataset

depvar_list = c('survey_2w',
                'genero',
                'salario_diario',
                'antiguedad', 
                'mon_tues',
                'angry',
                'mas_secundaria',
                'prob_ganar',
                'prob_mayor',
                'cantidad_ganar',
                'cant_mayor')

data_list = c('treatment_data_surveys',
          rep('treatment_data_2w', 10))


balance_ab_1_2w = map(1:7, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_ab', data = get(data_list[x])))


stargazer(lapply(balance_ab_1_2w, `[[`, 1),
          out = '../Tables/balance_ab_1_2w.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Success', 'Woman', 'Daily Wage', 'Tenure', 'Mon-Tu', 'Angry', 'More than Junior High'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_ab_1_2w, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```


```{r, results = 'asis'}

# Crear dataset


balance_ab_2_2w = map(7:10, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_ab', data = treatment_data_2w))


stargazer(lapply(balance_ab_2_2w, `[[`, 1),
          out = '../Tables/balance_ab_2_2w.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Baseline Probability', 'Baseline Prob. Above', 'Baseline Amt.', 'Baseline Amt. Above'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_ab_2_2w, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```

\pagebreak

### 2 Months

```{r, results = 'asis'}

# Crear dataset

depvar_list = c('survey_2m',
                'genero',
                'salario_diario',
                'antiguedad', 
                'mon_tues',
                'angry',
                'mas_secundaria',
                'prob_ganar',
                'prob_mayor',
                'cantidad_ganar',
                'cant_mayor')

data_list = c('treatment_data_surveys',
          rep('treatment_data_2m', 10))


balance_ab_1_2m = map(1:7, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_ab', data = get(data_list[x])))


stargazer(lapply(balance_ab_1_2m, `[[`, 1),
          out = '../Tables/balance_ab_1_2m.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Success', 'Woman', 'Daily Wage', 'Tenure', 'Mon-Tu', 'Angry', 'More than Junior High'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_ab_1_2m, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```


```{r, results = 'asis'}

# Crear dataset


balance_ab_2_2m = map(7:10, function(x) lm_nobs(depvar_list[[x]], 'grupo_tratamiento_ab', data = treatment_data_2m))


stargazer(lapply(balance_ab_2_2m, `[[`, 1),
          out = '../Tables/balance_ab_2_2m.tex',
          #type = 'html',
          dep.var.labels.include = F,
          dep.var.caption = "",
          font.size = 'scriptsize',
          keep = c('Constant', 'grupo_tratamiento'),
          covariate.labels = c('Constant', 'Treatment 2', 'Treatment 3'),
          column.labels = c('Baseline Probability', 'Baseline Prob. Above', 'Baseline Amt.', 'Baseline Amt. Above'),
          intercept.bottom = F,
          digits = 2,
          table.placement = 'h',
          header = F,
          omit.stat = c('adj.rsq', 'f', 'ser'),
          add.lines = list(c('Obs. per group', unlist(lapply(balance_ab_2_2m, `[[`, 2)))),
          notes = '',
          notes.append = F,
          notes.label = '')
```
